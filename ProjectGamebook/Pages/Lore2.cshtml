@page
@model ProjectGamebook.Pages.Lore2Model
@Html.AntiForgeryToken()
@{
}
<div class="location">
    <div class="location__main" style="background-image: url(/imgs/bgs/lore_room2.jpg);">
        <div style="position: absolute; top: 35%; left: 10%;" onclick="showBook()">
            <img src="/imgs/books/book2.png" class="book-img" />
        </div>
        <a asp-page="CreamBossFight"><div style="position: absolute; top: 00%; left: 50%; width: 45%; height: 80%; z-index: 2"></div></a>
    </div>
    <div id="book" class="book">
        <h1>The Food World</h1>
        <p>The origin of the Food World is shrouded in mystery. Although there are many scientists and historians researching this topic, there is still no definitive answer.</p>
        <p>However, a famous story says that the Food World was created by a celestial being called The One (or The Creator in the southwest regions or simply God in the northwest regions), the creator of humans.</p>
        <p>After creating humans and their home, he went on to create the Dream World, the Nightmare World, the Food World, the Drink World, the World of the Mind, the World of the Soul, the Microworld and the Macroworld (and the Heart of Cosmos, in some versions of the story).</p>
        <button class="btn btn--next" onclick="hideBook()">Close</button>
    </div>
    <div class="inventory">
        <div class="inventory-icon">
        </div>
    </div>
<div class="stats">
    <div class="stats__item">
        <p id="hp">HP: @Model.GS.HP</p>
        <progress id="hp-prog" max="100" value="@Model.GS.HP"></progress>
    </div>
    <div class="stats__item">
        <p id="dl">DL: @Model.GS.DL</p>
        <progress id="dl-prog" max="100" value="@Model.GS.DL"></progress>
    </div>
</div>
<div class="equipped-items">
    <div class="equipped-items__item">
        <p>Shield</p>
        <img class="equipped" id="shield" src="@Model.GS.EquippedShield.ImageUrl" />
    </div>
    <div class="equipped-items__item">
        <p>Weapon</p>
        <img class="equipped" id="weapon" src="@Model.GS.EquippedWeapon.ImageUrl" />
    </div>

</div>
<img class="equipped-desktop equipped-desktop--shield" id="shield-desktop" src="@Model.GS.EquippedShield.EquippedImageUrl" />
<img class="equipped-desktop equipped-desktop--weapon" id="weapon-desktop" src="@Model.GS.EquippedWeapon.EquippedImageUrl" />
<div class="textbox">
    <p class="textbox__main-text" id="locationText"></p>
    <button class="btn btn--next" id="btnNext">Next</button>
</div>

<script>
     let currentIndex = 0;
     var stringList = @Html.Raw(@Model.jsonString);

    function updateText() {
        document.getElementById("locationText").innerText = stringList[currentIndex];
        if (currentIndex === stringList.length - 1) {
            changeButtonVisibility();
        }
    }

    function changeButtonVisibility() {
        document.getElementById("btnNext").style.display = "none";
    }

    document.getElementById("btnNext").addEventListener("click", function () {
        currentIndex = currentIndex + 1;
        updateText();
    });

    updateText();

    function showBook() {
        console.log("opened book");
        document.getElementById("book").style.display = "block";
    }
    function hideBook() {
        document.getElementById("book").style.display = "none";
    }

</script>

                        
</div>