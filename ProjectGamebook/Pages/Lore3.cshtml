@page
@model ProjectGamebook.Pages.Lore3Model
@Html.AntiForgeryToken()
@{
}
<div class="location">
    <div class="location__main" style="background-image: url(/imgs/bgs/lore_room3.jpg);">
        <div style="position: absolute; top: 30%; left: 40%;" onclick="showBook()">
            <img src="/imgs/books/book3.png" class="book-img" />
        </div>
        <a asp-page="Location" asp-route-id="21"><div style="position: absolute; top: 00%; left: 55%; width: 45%; height: 90%; z-index: 2"></div></a>
    </div>
    <div id="book" class="book">
        <h1>The 25th Sweet Emperor</h1>
        <p>The 25th Sweet Emperor, also called The Tyrant, is the current sovereign of the Sweet Empire. He is a mysterious individual who never shows his face to the public. Most publicly accessible data about him are lies or half-truths.</p>
        <p>He became the emperor after the death of his father in 2003. He has been accused of patricide by many different individuals, however, there is no evidence to support this claim.</p>
        <button class="btn btn--next" onclick="hideBook()">Close</button>
    </div>
    <div class="inventory">
        <div class="inventory-icon">
        </div>
    </div>
    <div class="stats">
        <div class="stats__item">
            <p id="hp">HP: @Model.GS.HP</p>
            <progress id="hp-prog" max="100" value="@Model.GS.HP"></progress>
        </div>
        <div class="stats__item">
            <p id="dl">DL: @Model.GS.DL</p>
            <progress id="dl-prog" max="100" value="@Model.GS.DL"></progress>
        </div>
    </div>
    <div class="equipped-items">
        <div class="equipped-items__item">
            <p>Shield</p>
            <img class="equipped" id="shield" src="@Model.GS.EquippedShield.ImageUrl" />
        </div>
        <div class="equipped-items__item">
            <p>Weapon</p>
            <img class="equipped" id="weapon" src="@Model.GS.EquippedWeapon.ImageUrl" />
        </div>

    </div>
    <img class="equipped-desktop equipped-desktop--shield" id="shield-desktop" src="@Model.GS.EquippedShield.EquippedImageUrl" />
    <img class="equipped-desktop equipped-desktop--weapon" id="weapon-desktop" src="@Model.GS.EquippedWeapon.EquippedImageUrl" />
    <div class="textbox">
        <p class="textbox__main-text" id="locationText"></p>
        <button class="btn btn--next" id="btnNext">Next</button>
    </div>

    <script>
        let currentIndex = 0;
        var stringList = @Html.Raw(@Model.jsonString);

        function updateText() {
            document.getElementById("locationText").innerText = stringList[currentIndex];
            if (currentIndex === stringList.length - 1) {
                changeButtonVisibility();
            }
        }

        function changeButtonVisibility() {
            document.getElementById("btnNext").style.display = "none";
        }

        document.getElementById("btnNext").addEventListener("click", function () {
            currentIndex = currentIndex + 1;
            updateText();
        });

        updateText();

        function showBook() {
            console.log("opened book");
            document.getElementById("book").style.display = "block";
        }
        function hideBook() {
            document.getElementById("book").style.display = "none";
        }

    </script>


</div>